(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0418dd12"],{"0b81":function(e,t,a){"use strict";a("5de2")},"5de2":function(e,t,a){},7500:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"f",(function(){return u}));var r=a("b775"),n=function(e){return Object(r["a"])({url:"/employee/coach",params:e})},o=function(e){return Object(r["a"])({url:"/employee/coach",method:"post",data:e})},i=function(e){return Object(r["a"])({url:"/employee/coach",method:"delete",data:{id:e}})},s=function(e){return Object(r["a"])({url:"/employee/coach",params:{id:e}})},c=function(e){return Object(r["a"])({url:"/employee/coach",method:"put",data:e})},d=function(){return Object(r["a"])({url:"/coach/all"})},u=function(e){return Object(r["a"])({url:"/coach/all",method:"put",data:e})}},"7db0":function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").find,o=a("44d2"),i="find",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o(i)},8194:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"g",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"c",(function(){return u}));var r=a("b775"),n=function(e){return Object(r["a"])({url:"/member",method:"get",params:e})},o=function(e){return Object(r["a"])({url:"/member/add",method:"post",data:e})},i=function(e){return Object(r["a"])("/member?id=".concat(e))},s=function(e){return Object(r["a"])({url:"/member/edit",method:"put",data:e})},c=function(e){return Object(r["a"])({url:"/member/del",method:"delete",data:{id:e}})},d=function(e){return Object(r["a"])({url:"/member/renew",method:"put",data:e})},u=function(){return Object(r["a"])({url:"/member/all",method:"get"})}},"8d51":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i}));var r=a("69ed"),n=a.n(r),o=(a("5f72"),{COS_SecretId:"AKIDToXFlHl8NSOBGE1gBYlqqr084ulU1KQI",COS_SecretKey:"qTvAD3iAcqqeFcmiQyLUSEmX7XnFYdVN",COS_Region:"ap-guangzhou",COS_Bucket:"fitness-1309672163"}),i=new n.a({SecretId:o.COS_SecretId,SecretKey:o.COS_SecretKey})},d3bc:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-card"},[a("header",{staticClass:"add-header"},[a("el-page-header",{attrs:{content:e.showTitle},on:{back:function(t){return e.$router.back()}}})],1),a("main",{staticClass:"add-main"},[a("div",{staticClass:"form-container"},[a("div",{staticClass:"title"},[e._v("会员信息")]),a("div",{staticClass:"form"},[a("el-form",{ref:"addForm",attrs:{"label-width":"100px",model:e.addForm,rules:"see"===e.$route.query.type?{}:e.rules}},[a("el-form-item",{attrs:{label:"会员姓名",prop:"name"}},["see"!==e.$route.query.type?a("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}}):a("span",[e._v(e._s(e.addForm.name))])],1),a("el-form-item",{attrs:{label:"联系方式",prop:"photo"}},["see"!==e.$route.query.type?a("el-input",{model:{value:e.addForm.photo,callback:function(t){e.$set(e.addForm,"photo",t)},expression:"addForm.photo"}}):a("span",[e._v(e._s(e.addForm.photo))])],1),a("el-form-item",{attrs:{label:"身份证号码",prop:"identityCard"}},["see"!==e.$route.query.type?a("el-input",{model:{value:e.addForm.identityCard,callback:function(t){e.$set(e.addForm,"identityCard",t)},expression:"addForm.identityCard"}}):a("span",[e._v(e._s(e.addForm.identityCard))])],1),a("el-form-item",{attrs:{label:"健身卡",prop:"cards"}},["see"!==e.$route.query.type?a("el-select",{model:{value:e.addForm.cards,callback:function(t){e.$set(e.addForm,"cards",t)},expression:"addForm.cards"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1):a("span",[e._v(e._s(e.cardsObj[e.addForm.cards]))])],1),a("el-form-item",{attrs:{label:"会员课",prop:"course"}},["see"!==e.$route.query.type?a("el-input",{attrs:{type:"number",min:"0",max:"50"},model:{value:e.addForm.course,callback:function(t){e.$set(e.addForm,"course",t)},expression:"addForm.course"}}):a("span",[e._v(e._s(e.addForm.course))])],1),a("el-form-item",{attrs:{label:"专属私教",prop:"coach"}},["see"!==e.$route.query.type?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.coach,callback:function(t){e.$set(e.addForm,"coach",t)},expression:"addForm.coach"}},e._l(e.coachList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1):a("span",[e._v(e._s(e.addForm.coach?e.addForm.coach:"无"))])],1),a("el-form-item",{attrs:{label:"支付金额",prop:"payNum"}},["see"!==e.$route.query.type?a("el-input",{model:{value:e.addForm.payNum,callback:function(t){e.$set(e.addForm,"payNum",t)},expression:"addForm.payNum"}}):a("span",[e._v(e._s(e.addForm.payNum))])],1),a("el-form-item",{attrs:{label:"支付方式",prop:"paymentMethod"}},["see"!==e.$route.query.type?a("el-select",{model:{value:e.addForm.paymentMethod,callback:function(t){e.$set(e.addForm,"paymentMethod",t)},expression:"addForm.paymentMethod"}},e._l(e.payOptions,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1):a("span",[e._v(e._s(e.paymentObj[e.addForm.paymentMethod]))])],1),a("el-form-item",{attrs:{label:"有效日期",prop:"timeDate"}},["see"!==e.$route.query.type?a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.addForm.timeDate,callback:function(t){e.$set(e.addForm,"timeDate",t)},expression:"addForm.timeDate"}}):a("span",[e._v(e._s(e.addForm.startTime+"至"+e.addForm.endTime))])],1),a("el-form-item",{attrs:{label:"会员照片",prop:"image"}},[0===e.fileList.length&&"see"!==e.$route.query.type?a("el-upload",{staticClass:"upload-demo",attrs:{action:"#","before-upload":e.beforeUpload,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1):e._e(),0!==e.fileList.length?a("div",{staticClass:"imgBox"},[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.imageUrl,fit:"cover"}}),"see"!==e.$route.query.type?a("a",{staticStyle:{position:"absolute",transform:"translate(-120%, -20%)"},attrs:{href:"javascript:;"},on:{click:e.handleRemove}},[a("i",{staticClass:"el-icon-circle-close"})]):e._e()],1):e._e()],1)],1)],1)])]),"see"!==e.$route.query.type?a("footer",{staticClass:"add-footer"},[a("div",{staticClass:"btn-container"},[a("el-button",{on:{click:e.resetForm}},[e._v("重置")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)]):e._e()])},n=[],o=a("5530"),i=a("2909"),s=a("c7eb"),c=a("1da1"),d=(a("99af"),a("b0c0"),a("14d9"),a("7db0"),a("d3b7"),a("8194")),u=a("7500"),l=a("8d51"),m={name:"AddMember",data:function(){return{coachList:[],imageUrl:"",fileList:[],paymentObj:{Alipay:"支付宝",WeChat:"微信",Cash:"线下支付 "},cardsObj:{day:"天卡",week:"周卡",month:"月卡",season:"季卡",halfYear:"半年卡",year:"年卡",permanent:"永久卡"},options:[{value:"day",label:"天卡"},{value:"week",label:"周卡"},{value:"month",label:"月卡"},{value:"season",label:"季卡"},{value:"halfyear",label:"半年卡"},{value:"year",label:"年卡"},{value:"permanent",label:"永久卡"}],payOptions:[{value:"Alipay",label:"支付宝"},{value:"WeChat",label:"微信"},{value:"Cash",label:"线下支付"}],addForm:{name:"",photo:"",cards:"",timeDate:"",paymentMethod:"",identityCard:"",course:0,coach:"",payNum:"",image:""},rules:{name:[{required:!0,message:"请输入会员名称",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],photo:[{required:!0,message:"请输入联系方式",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"手机号码格式不对"}],cards:[{required:!0,message:"请选择会员卡",trigger:"change"}],timeDate:[{type:"array",required:!0,message:"请选择有效日期",trigger:"change"}],paymentMethod:[{required:!0,message:"请选择支付方式",trigger:"change"}],identityCard:[{required:!0,message:"请输入身份证号",trigger:"blur"}],payNum:[{required:!0,message:"请输入支付金额 ",trigger:"blur"},{pattern:/^\d+(\.\d{1,2})?$/,message:"支付金额格式不对"}],image:[{type:"string",required:!0,message:"请上传会员图片",trigger:"blur"}]}}},computed:{showTitle:function(){var e={see:"查看会员",edit:"编辑会员",add:"添加会员"};return e[this.$route.query.type]}},created:function(){"add"!==this.$route.query.type&&this.getMember(),this.getAllCoachList()},methods:{updateCourse:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.addForm.coach>0)){t.next=9;break}if(0!==e.addForm.course){t.next=4;break}return e.$message.error("请先填入课程数"),t.abrupt("return");case 4:return a={course:e.addForm.course,id:e.addForm.coach},t.next=7,Object(u["f"])(a);case 7:t.next=15;break;case 9:if(!(e.addForm.course>0)){t.next=14;break}return e.$message.error("请先选择教练"),t.abrupt("return");case 14:return t.abrupt("return");case 15:case"end":return t.stop()}}),t)})))()},getAllCoachList:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])();case 2:a=t.sent,e.coachList=[{id:0,name:"无"}].concat(Object(i["a"])(a.data));case 4:case"end":return t.stop()}}),t)})))()},deleteFile:function(e){var t=this;l["a"].deleteObject({Bucket:l["b"].COS_Bucket,Region:l["b"].COS_Region,Key:e},(function(e,a){e?t.$message.error("删除失败."):(t.$message.success("删除成功."),t.fileList=[])}))},uploadFile:function(e){var t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:l["a"].uploadFile({Bucket:l["b"].COS_Bucket,Region:l["b"].COS_Region,Key:e.name,Body:e,SliceSize:5242880,onProgress:function(e){}},(function(e,a){e?t.$message.error("上传失败"):(t.fileList=[],t.$message.success("上传成功"),t.imageUrl="https://".concat(a.Location),t.addForm.image="https://".concat(a.Location),t.fileList.push({name:a.Location.split("/")[1],url:a.Location}),t.$refs.addForm.validateField("image"))}));case 1:case"end":return a.stop()}}),a)})))()},beforeUpload:function(e){this.uploadFile(e)},handleRemove:function(e,t){var a=this;this.$confirm("确定移除 ".concat(this.fileList[0].name,"？")).then((function(){a.addForm.image="",a.$refs.addForm.validateField("image"),a.fileList=[]}))},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},getMember:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fileList=[],t.next=3,Object(d["d"])(e.$route.query.id);case 3:a=t.sent,e.addForm=Object(o["a"])(Object(o["a"])({},a.data),{},{timeDate:[a.data.startTime,a.data.endTime]}),""!==e.addForm.image&&(r=e.addForm.image.split("/"),e.fileList.push({name:r[r.length-1],url:e.addForm.image}),e.imageUrl=e.addForm.image);case 6:case"end":return t.stop()}}),t)})))()},submitForm:function(){var e=this;this.$refs.addForm.validate(function(){var t=Object(c["a"])(Object(s["a"])().mark((function t(a){var r,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(r=e.coachList.find((function(t){return t.id===e.addForm.coach})),n=e.addForm,n.startTime=e.addForm.timeDate[0],n.endTime=e.addForm.timeDate[1],n.coach=r.name,delete n.timeDate,"add"!==e.$route.query.type){t.next=15;break}return t.next=11,Object(d["a"])(n);case 11:e.updateCourse(),e.$message.success("添加成功."),t.next=19;break;case 15:return t.next=17,Object(d["g"])(n);case 17:e.updateCourse(),e.$message.success("修改成功.");case 19:e.$refs.addForm.resetFields(),e.$router.back();case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},resetForm:function(){this.$refs.addForm.resetFields()}}},p=m,f=(a("0b81"),a("2877")),b=Object(f["a"])(p,r,n,!1,null,"919bf81a",null);t["default"]=b.exports}}]);