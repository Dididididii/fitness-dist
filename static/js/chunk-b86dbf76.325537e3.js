(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b86dbf76"],{"53d4":function(e,t,a){"use strict";a("b880")},"6f56":function(e,t,a){"use strict";a.d(t,"l",(function(){return r})),a.d(t,"j",(function(){return i})),a.d(t,"g",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"h",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"m",(function(){return m})),a.d(t,"f",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"b",(function(){return b})),a.d(t,"e",(function(){return f})),a.d(t,"n",(function(){return h})),a.d(t,"k",(function(){return g}));var n=a("b775"),r=function(e){return Object(n["a"])({url:"/clocking/signin",method:"post",data:e})},i=function(e){return Object(n["a"])({url:"/clocking/signin",params:e})},s=function(e){return Object(n["a"])({url:"/clocking/clockin",params:e})},o=function(e){return Object(n["a"])({url:"/clocking/clockin",method:"post",data:{clockingTime:e}})},c=function(e){return Object(n["a"])({url:"/clocking/clockout",method:"put",data:{checkOutTime:e}})},l=function(e){return Object(n["a"])({url:"/clocking/leave",params:e})},u=function(e){return Object(n["a"])({url:"/clocking/askleave",method:"post",data:e})},m=function(e){return Object(n["a"])({url:"/clocking/askleave",method:"put",data:e})},d=function(e){return Object(n["a"])({url:"/clocking/askleave?clockId=".concat(e),method:"delete"})},p=function(e){return Object(n["a"])({url:"/clocking/over",params:e})},b=function(e){return Object(n["a"])({url:"/clocking/over",method:"post",data:e})},f=function(e){return Object(n["a"])({url:"/clocking/over",method:"delete",data:{id:e}})},h=function(e){return Object(n["a"])({url:"/clocking/over",method:"put",data:e})},g=function(){return Object(n["a"])({url:"/clocking/clockin/today"})}},7624:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-container"},[a("div",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:search",expression:"'member:manage:search'"}],staticClass:"search-container"},[a("span",{staticClass:"search-label"},[e._v("会员姓名：")]),a("el-input",{staticClass:"search-main",attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),a("span",{staticClass:"search-label"},[e._v("会员手机号码：")]),a("el-input",{staticClass:"search-main",attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.params.photo,callback:function(t){e.$set(e.params,"photo",t)},expression:"params.photo"}}),a("span",{staticClass:"search-label"},[e._v("卡类：")]),a("el-select",{model:{value:e.params.cards,callback:function(t){e.$set(e.params,"cards",t)},expression:"params.cards"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:e.searchMember}},[e._v("查询")])],1),a("div",{staticClass:"create-container"},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:add",expression:"'member:manage:add'"}],attrs:{type:"primary"},on:{click:function(t){return e.$router.push({path:"/member/add",query:{type:"add"}})}}},[e._v("添加会员")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:del",expression:"'member:manage:del'"}],on:{click:e.selectDel}},[e._v("批量删除")]),a("el-button",{attrs:{type:"success"},on:{click:e.exportToExcel}},[e._v("导出execl")])],1),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userList},on:{"selection-change":e.selectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",label:"序号",index:e.indexMethod}}),a("el-table-column",{attrs:{label:"会员名称",prop:"name"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"photo"}}),a("el-table-column",{attrs:{label:"会员卡",prop:"cards"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.cardsObj[t.row.cards]))]}}])}),a("el-table-column",{attrs:{label:"支付金额(元)",prop:"payNum",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.payNum?t.row.payNum:"0"))]}}])}),a("el-table-column",{attrs:{label:"支付方式",prop:"paymentMethod",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.paymentObj[t.row.paymentMethod]))]}}])}),a("el-table-column",{attrs:{label:"课程(节)",prop:"course",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.course?t.row.course:"0"))]}}])}),a("el-table-column",{attrs:{label:"专属私教",prop:"coach",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.coach?t.row.coach:"无"))]}}])}),a("el-table-column",{attrs:{label:"有效日期",prop:"startTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.startTime+"至"+t.row.endTime))]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:singin",expression:"'member:manage:singin'"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.signIn(t.row)}}},[e._v("签到")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:change",expression:"'member:manage:change'"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.renewCards(t.row)}}},[e._v("续费")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:see",expression:"'member:manage:see'"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.seeMember(t.row.id)}}},[e._v("查看")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:edit",expression:"'member:manage:edit'"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.editMember(t.row.id)}}},[e._v("编辑")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"member:manage:del",expression:"'member:manage:del'"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.delMember(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{layout:"total, prev, pager, next",total:e.total,"page-size":e.params.pageSize},on:{"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"续费会员卡",visible:e.dialogFormVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"续费时间",prop:"timeDate"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.timeDate,callback:function(t){e.$set(e.ruleForm,"timeDate",t)},expression:"ruleForm.timeDate"}})],1),a("el-form-item",{attrs:{label:"支付金额",prop:"payNum"}},[a("el-input",{model:{value:e.ruleForm.payNum,callback:function(t){e.$set(e.ruleForm,"payNum",t)},expression:"ruleForm.payNum"}})],1),a("el-form-item",{attrs:{label:"支付方式",prop:"paymentMethod"}},[a("el-select",{model:{value:e.ruleForm.paymentMethod,callback:function(t){e.$set(e.ruleForm,"paymentMethod",t)},expression:"ruleForm.paymentMethod"}},e._l(e.payOptions,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRenew}},[e._v("提交")]),a("el-button",{on:{click:e.resetRenew}},[e._v("重置")])],1)],1)],1)],1)},r=[],i=a("5530"),s=a("c7eb"),o=a("1da1"),c=(a("d81d"),a("d3b7"),a("99af"),a("159b"),a("14d9"),a("8194")),l=a("6f56"),u=a("25ca"),m={name:"Manage",data:function(){return{loading:!0,ruleForm:{timeDate:"",payNum:"",paymentMethod:""},dialogFormVisible:!1,options:[{value:null,label:"全部"},{value:"day",label:"天卡"},{value:"week",label:"周卡"},{value:"month",label:"月卡"},{value:"season",label:"季卡"},{value:"halfyear",label:"半年卡"},{value:"year",label:"年卡"},{value:"permanent",label:"永久卡"}],params:{name:null,photo:null,cards:null,page:1,pageSize:2},userList:[],total:0,paymentObj:{Alipay:"支付宝",WeChat:"微信",Cash:"线下支付 "},cardsObj:{day:"天卡",week:"周卡",month:"月卡",season:"季卡",halfYear:"半年卡",year:"年卡",permanent:"永久卡"},selectList:[],payOptions:[{value:"Alipay",label:"支付宝"},{value:"WeChat",label:"微信"},{value:"Cash",label:"线下支付"}],rules:{timeDate:[{required:!0,type:"array",message:"请选择续费时间",trigger:"change"}],payNum:[{required:!0,type:"string",message:"请填写支付金额",trigger:"blur"},{pattern:/^\d+(\.\d{1,2})?$/,message:"支付金额格式不对"}],paymentMethod:[{required:!0,message:"请选择支付方式",trigger:"change"}]}}},created:function(){this.getMemberList()},methods:{daysRemaining:function(e,t){var a=t,n=e,r=a-n;return r>0?Math.floor(r/864e5):0},format:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),s=t.getMinutes(),o=t.getSeconds();return a+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+":"+(o<10?"0"+o:o)},signIn:function(e){var t=this,a=e;a.time=this.format((new Date).getTime());var n=new Date(a.startTime).getTime(),r=new Date(a.endTime).getTime(),i=this.daysRemaining(n,r);a.residue="".concat(i>10?i:"0"+i),delete a.startTime,delete a.endTime,delete a.identityCard,delete a.payNum,delete a.paymentMethod,this.$confirm("此会员是否已到店内?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["l"])(a);case 2:t.$message({type:"success",message:"签到成功!"});case 3:case"end":return e.stop()}}),e)}))))},exportToExcel:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a,n,r,i,o,l;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["c"])();case 2:a=t.sent,n=["name","photo","cards","payNum","paymentMethod","course","coach","timeDate"],r=["会员名称","联系号码","会员卡","支付金额(元)","支付方式","会员课","专属私教","有效日期"],i=a.data.map((function(t){var a={};return n.forEach((function(n){"timeDate"===n&&(t[n]="".concat(t.startTime,"至").concat(t.endTime),a[n]=t[n]),"cards"===n&&(t[n]=e.cardsObj[t[n]],a[n]=t[n]),"paymentMethod"===n&&(t[n]=e.paymentObj[t[n]],a[n]=t[n]),a[n]=t[n]})),a})),o=u["a"].utils.json_to_sheet(i),l=u["a"].utils.book_new(),u["a"].utils.book_append_sheet(l,o,"Data"),u["a"].utils.sheet_add_aoa(o,[r],{origin:"A1"}),u["a"].writeFileXLSX(l,"memberInfo.xlsx");case 11:case"end":return t.stop()}}),t)})))()},resetRenew:function(){this.ruleForm={timeDate:"",payNum:"",paymentMethod:""},this.$refs.ruleForm.resetFields()},submitRenew:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(s["a"])().mark((function t(a){var n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return n=Object(i["a"])(Object(i["a"])({},e.ruleForm),{},{startTime:e.ruleForm.timeDate[0],endTime:e.ruleForm.timeDate[1]}),delete n.timeDate,t.next=6,Object(c["f"])(n);case 6:e.$message.success("续费成功."),e.dialogFormVisible=!1,e.getMemberList();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},renewCards:function(e){this.dialogFormVisible=!0,this.ruleForm={id:e.id,timeDate:[e.startTime,e.endTime],payNum:e.payNum,paymentMethod:e.paymentMethod}},selectDel:function(){var e=this;0!==this.selection.length?this.$confirm("确认删除所选会员吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["b"])(e.selection);case 2:e.$message.success("删除成功"),e.getMemberList();case 4:case"end":return t.stop()}}),t)})))):this.$message.error("请先选择需要删除的会员")},selectionChange:function(e){this.selection=e.map((function(e){return e.id}))},delMember:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认删除所选会员吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["b"])(e);case 2:t.$message.success("删除成功"),t.getMemberList();case 4:case"end":return a.stop()}}),a)}))));case 1:case"end":return a.stop()}}),a)})))()},editMember:function(e){this.$router.push({path:"/member/add",query:{id:e,type:"edit"}})},seeMember:function(e){this.$router.push({path:"/member/add",query:{id:e,type:"see"}})},searchMember:function(){this.params.page=1,this.getMemberList()},indexMethod:function(e){return e+1+(this.params.page-1)*this.params.pageSize},handleCurrentChange:function(e){this.params.page=e,this.getMemberList()},getMemberList:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c["e"])(e.params);case 3:a=t.sent,e.userList=a.data.rows,e.total=a.data.total,e.loading=!1;case 7:case"end":return t.stop()}}),t)})))()}}},d=m,p=(a("53d4"),a("2877")),b=Object(p["a"])(d,n,r,!1,null,"599fc4fc",null);t["default"]=b.exports},8194:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"b",(function(){return c})),a.d(t,"f",(function(){return l})),a.d(t,"c",(function(){return u}));var n=a("b775"),r=function(e){return Object(n["a"])({url:"/member",method:"get",params:e})},i=function(e){return Object(n["a"])({url:"/member/add",method:"post",data:e})},s=function(e){return Object(n["a"])("/member?id=".concat(e))},o=function(e){return Object(n["a"])({url:"/member/edit",method:"put",data:e})},c=function(e){return Object(n["a"])({url:"/member/del",method:"delete",data:{id:e}})},l=function(e){return Object(n["a"])({url:"/member/renew",method:"put",data:e})},u=function(){return Object(n["a"])({url:"/member/all",method:"get"})}},b880:function(e,t,a){}}]);