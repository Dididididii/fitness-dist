(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78a6c51a"],{"6e70":function(e,t,r){"use strict";r("f5eb")},"821b":function(e,t,r){"use strict";r.d(t,"e",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return u}));var a=r("b775"),i=function(e){return Object(a["a"])({url:"/show",params:e})},o=function(e){return Object(a["a"])({url:"/show",params:{id:e}})},n=function(e){return Object(a["a"])({url:"/show",method:"post",data:e})},s=function(e){return Object(a["a"])({url:"/show",method:"delete",data:{id:e}})},c=function(e){return Object(a["a"])({url:"/show",method:"put",data:e})},d=function(e){return Object(a["a"])({url:"/show/isshow",params:{isshow:e}})},u=function(e){return Object(a["a"])({url:"/show/isshow",method:"put",data:e})}},"8d51":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return n}));var a=r("69ed"),i=r.n(a),o=(r("5f72"),{COS_SecretId:"AKIDToXFlHl8NSOBGE1gBYlqqr084ulU1KQI",COS_SecretKey:"qTvAD3iAcqqeFcmiQyLUSEmX7XnFYdVN",COS_Region:"ap-guangzhou",COS_Bucket:"fitness-1309672163"}),n=new i.a({SecretId:o.COS_SecretId,SecretKey:o.COS_SecretKey})},b6ce:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-card"},[r("header",{staticClass:"add-header"},[r("el-page-header",{attrs:{content:e.showTitle},on:{back:function(t){return e.$router.back()}}})],1),r("main",{staticClass:"add-main"},[r("div",{staticClass:"form-container"},[r("div",{staticClass:"title"},[e._v("活动信息")]),r("div",{staticClass:"form"},[r("el-form",{ref:"addForm",attrs:{"label-width":"100px",model:e.addForm,rules:"see"===e.$route.query.type?{}:e.addFormRules}},[r("el-form-item",{attrs:{label:"活动标题",prop:"title"}},[r("el-input",{attrs:{disabled:"see"===e.$route.query.type},model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),r("el-form-item",{attrs:{label:"活动内容",prop:"content"}},[r("quillEditor",{attrs:{disabled:"see"===e.$route.query.type},on:{blur:function(t){return e.$refs.addForm.validateField("content")}},model:{value:e.addForm.content,callback:function(t){e.$set(e.addForm,"content",t)},expression:"addForm.content"}})],1),r("el-form-item",{attrs:{label:"页面展示",prop:"show"}},[r("el-radio",{attrs:{label:"0",border:"",disabled:"see"===e.$route.query.type},model:{value:e.addForm.isshow,callback:function(t){e.$set(e.addForm,"isshow",t)},expression:"addForm.isshow"}},[e._v("不展示")]),r("el-radio",{attrs:{label:"1",border:"",disabled:"see"===e.$route.query.type},model:{value:e.addForm.isshow,callback:function(t){e.$set(e.addForm,"isshow",t)},expression:"addForm.isshow"}},[e._v("展示")])],1),r("el-form-item",{attrs:{label:"活动海报",prop:"image"}},["see"!==e.$route.query.type?r("el-upload",{staticClass:"upload-demo",attrs:{"http-request":e.uploadFile,action:"#",multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList,"before-remove":e.beforeRemove,"on-remove":e.handleRemove}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1):r("el-image",{staticStyle:{width:"500px",height:"300px"},attrs:{src:e.addForm.image,fit:"cover"}})],1)],1)],1)])]),"see"!==e.$route.query.type?r("footer",{staticClass:"add-footer"},[r("div",{staticClass:"btn-container"},[r("el-button",{on:{click:e.resetForm}},[e._v("重置")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)]):e._e()])},i=[],o=r("5530"),n=r("c7eb"),s=r("1da1"),c=(r("14d9"),r("b0c0"),r("99af"),r("a753"),r("8096"),r("14e1"),r("18d9")),d=r("821b"),u=r("8d51"),l={components:{quillEditor:c["quillEditor"]},data:function(){return{fileList:[],addForm:{title:"",content:"",isshow:"0",image:""},addFormRules:{title:[{required:!0,message:"请填写活动标题",trigger:"blur"}],content:[{required:!0,message:"请填写活动内容",trigger:"blur"}],image:[{required:!0,message:"请上传活动海报",trigger:"change"}]}}},computed:{showTitle:function(){var e={see:"查看活动",edit:"编辑活动"};return e[this.$route.query.type]||"发布活动"}},created:function(){"add"!==this.$route.query.type&&this.getShowItem()},methods:{getShowItem:function(){var e=this;return Object(s["a"])(Object(n["a"])().mark((function t(){var r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["d"])(e.$route.query.id);case 2:r=t.sent,e.addForm={title:r.data.title,content:r.data.content,isshow:1===r.data.isshow?"1":"0",image:r.data.image},e.fileList.push({name:e.addForm.image.split("/")[e.addForm.image.split("/").length-1],url:e.addForm.image});case 5:case"end":return t.stop()}}),t)})))()},handleRemove:function(e,t){this.addForm.image="",this.fileList=[],this.$refs.addForm.validateField("image")},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},deleteFile:function(e){var t=this;u["a"].deleteObject({Bucket:u["b"].COS_Bucket,Region:u["b"].COS_Region,Key:e},(function(e,r){e?t.$message.error("删除失败."):(t.$message.success("删除成功."),t.fileList=[])}))},uploadFile:function(e){var t=this;return Object(s["a"])(Object(n["a"])().mark((function r(){var a;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=e.file,u["a"].uploadFile({Bucket:u["b"].COS_Bucket,Region:u["b"].COS_Region,Key:a.name,Body:a,SliceSize:5242880,onProgress:function(e){}},(function(e,r){e?(console.log("上传失败",e),t.$message.error("上传失败")):(t.fileList=[],t.$message.success("上传成功"),t.addForm.image="https://".concat(r.Location),t.fileList.push({name:r.Location.split("/")[1],url:r.Location}),t.$refs.addForm.validateField("image"))}));case 2:case"end":return r.stop()}}),r)})))()},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},submitForm:function(){var e=this;this.$refs.addForm.validate(function(){var t=Object(s["a"])(Object(n["a"])().mark((function t(r){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return a={title:e.addForm.title,content:e.addForm.content,isshow:1*e.addForm.isshow,image:e.addForm.image},t.next=5,Object(d["f"])(a.isshow);case 5:if(!e.addForm.id){t.next=11;break}return t.next=8,Object(d["c"])(Object(o["a"])({id:e.addForm.id},a));case 8:e.$message.success("编辑成功"),t.next=14;break;case 11:return t.next=13,Object(d["a"])(a);case 13:e.$message.success("发布成功");case 14:e.$router.back();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},resetForm:function(){this.$refs.addForm.resetFields(),this.fileList=[]}}},m=l,f=(r("6e70"),r("2877")),h=Object(f["a"])(m,a,i,!1,null,"5fea59ba",null);t["default"]=h.exports},f5eb:function(e,t,r){}}]);